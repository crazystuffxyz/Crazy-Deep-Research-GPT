import axios from"axios";import{JSDOM}from"jsdom";import{Readability}from"@mozilla/readability";async function extractArticleText(e){try{const t=(await axios.get(e,{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"en-US,en;q=0.9",dnt:"1",priority:"u=0, i","sec-ch-ua":'"Google Chrome";v="137", "Chromium";v="137", "Not/A)Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"none","sec-fetch-user":"?1","upgrade-insecure-requests":"1","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36"},timeout:15e3})).data,r=new JSDOM(t,{url:e,runScripts:void 0,resources:"usable"}),o=new Readability(r.window.document).parse();if(o&&o.content)return o.content;{const t=`[extractArticleText] Readability could not find main content on ${e}. The page might not be an article.`;return console.warn(t),`Error: Could not extract readable content from ${e}. The page might not be an article or is structured in a way that Readability cannot process.`}}catch(t){let r=`[extractArticleText] Error processing URL ${e}: `;if(axios.isAxiosError(t))if(r+=`Status ${t.response?.status||"N/A"} - ${t.message}`,"ECONNABORTED"===t.code)r+=" (Timeout)";else{if(404===t.response?.status)return`Error: Content not found (404) at ${e}.`;if(403===t.response?.status)return`Error: Access forbidden (403) at ${e}.`}else"DOMException"===t.constructor.name&&t.message.includes("Could not parse")?r+="JSDOM parsing error (likely invalid HTML or non-HTML content type)":r+=t.message||"Unknown error";return console.error(r),`Error: ${r}`}}export{extractArticleText};